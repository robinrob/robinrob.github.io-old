cc.game.onStart=function(){cc.view.adjustViewPort(!0),cc.view.setDesignResolutionSize(800,450,cc.ResolutionPolicy.SHOW_ALL),cc.view.resizeWithBrowserSize(!0),cc.LoaderScene.preload(rss.resources,function(){cc.director.runScene(new GameScene)},this)},cc.game.run();var rss=rss||{};cp.Space.prototype.addConstraints=function(a){var b=this;a.forEach(function(a){b.addConstraint(a)})},cc.Node.prototype.seq=function(){var a=arguments.length>1?cc.Sequence.create.apply(cc.Sequence,arguments):arguments[0];return this.runAction(a),a},cc.Node.prototype.spawn=function(a,b){var c=cc.Spawn.create.apply(cc.Spawn,arguments);return this.runAction(c),c},cp.Vect.prototype.toP=function(){return cc.p(this.x,this.y)},cp.Vect.prototype.addX=function(a){return cp.v(this.x+a,this.y)},cp.Vect.prototype.addY=function(a){return cp.v(this.x,this.y+a)},cp.Vect.prototype.subX=function(a){return cp.v(this.x-a,this.y)},cp.Vect.prototype.subY=function(a){return cp.v(this.x,this.y-a)},rss.logO=function(a){for(i in a)cc.log(i)},rss.logP=function(a,b){if(!b)var b="point";cc.log(b+".x: "+a.x),cc.log(b+".y: "+a.y)},rss.logS=function(a){if(!b)var b="size";cc.log(b+".width: "+a.width),cc.log(b+".height: "+a.height)},rss.logDeg=function(a,b){if(!b)var b="angle";cc.log(b+" (deg): "+cc.radiansToDegrees(a))},rss.toV=function(a){return cp.v(a.x,a.y)},rss.vertsToPs=function(a,b){b=b||cc.p();for(var c=[],d=0;d<a.length-1;d+=2)c.push(cc.p(a[d]+b.x,a[d+1]+b.y));return c},rss.offsetVerts=function(a,b){var c=[];return a.forEach(function(a){c.push(cc.p(a.x+b.x,a.y+b.y))}),c},rss.sum=function(a){var b=0;for(var c in a)b+=a[c];return b},rss.sign=function(a){return a?0>a?-1:1:0},rss.add=function(a,b){return cc.p(a.x+b.x,a.y+b.y)},rss.addX=function(a,b){return cc.p(a.x+b,a.y)},rss.addY=function(a,b){return cc.p(a.x,a.y+b)},rss.sub=function(a,b){return cc.p(a.x-b.x,a.y-b.y)},rss.subX=function(a,b){return cc.p(a.x-b,a.y)},rss.subY=function(a,b){return cc.p(a.x,a.y-b)},rss.mult=function(a,b){return cc.p(a.x*b,a.y*b)},rss.multS=function(a,b){return cc.size(a.width*b,a.height*b)},rss.addW=function(a,b){return cc.size(a.width+b,a.height)},rss.addH=function(a,b){return cc.size(a.width,a.height+b)},rss.subW=function(a,b){return cc.size(a.width-b,a.height)},rss.subH=function(a,b){return cc.size(a.width,a.height-b)},rss.vecFromTo=function(a,b){return rss.sub(b,a)},rss.unitVecFromTo=function(a,b){return rss.normalize(rss.sub(b,a))},rss.normalVecTo=function(a){return cc.p(-1*a.y,a.x)},rss.rotate=function(a,b){return cc.p(a.x*Math.cos(b)-a.y*Math.sin(b),a.x*Math.sin(b)+a.y*Math.cos(b))},rss.rotate90=function(a){return cc.p(-1*a.y,a.x)},rss.rotate180=function(a){return cc.p(-1*a.x,-1*a.y)},rss.rotate270=function(a){return cc.p(a.y,-1*a.x)},rss.rotateAll=function(a,b){var c=[];return a.forEach(function(a){c.push(rss.rotate(a,b))}),c},rss.distance=function(a,b){return rss.mag({x:b.x-a.x,y:b.y-a.y})},rss.mag=function(a){return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))},rss.normalize=function(a){return cc.p(a.x/rss.mag(a),a.y/rss.mag(a))},rss.unitVec=function(a){return cc.p(a.x/rss.mag(a),a.y/rss.mag(a))},rss.toRad=function(a){return cc.degreesToRadians(a)},rss.toDeg=function(a){return cc.radiansToDegrees(a)},rss.polarXProj=function(a,b){return a*Math.cos(b)},rss.polarYProj=function(a,b){return a*Math.sin(b)},rss.polarToCartesian=function(a,b){return cc.p(rss.polarXProj(a,b),rss.polarYProj(a,b))},rss.pinJoint=function(a,b){return[new cp.PinJoint(a.getBody(),b.getBody(),rss.toV(a.getJointP()),rss.toV(b.getJointP()))]},rss.pivotJoint=function(a,b){return[new cp.PivotJoint(a.getBody(),b.getBody(),a.getJointP(!0))]},rss.gearJoint=function(a,b,c,d){return[new cp.GearJoint(a.getBody(),b.getBody(),c,d)]},rss.slideJoint=function(a,b){return[new cp.SlideJoint(a.getBody(),b.getBody(),a.getJointPs()[0],a.getJointPs()[1],b.getJointP())]},rss.grooveJoint=function(a,b){return[new cp.GrooveJoint(a.getBody(),b.getBody(),a.getJointPs()[0],a.getJointPs()[1],b.getJointP())]},rss.ratchetJoint=function(a,b,c,d){return[new cp.RatchetJoint(a.getBody(),b.getBody(),c,d)]},rss.fixedJoint=function(a,b,c){var c=c||0;return rss.gearJoint(a,b,c,1).concat(rss.pivotJoint(a,b))},rss.rotaryLimitJoint=function(a,b,c,d){return[new cp.RotaryLimitJoint(a.getBody(),b.getBody(),c,d)]},rss.size=function(){return cc.director.getWinSize()},rss.width=function(){return cc.director.getWinSize().width},rss.height=function(){return cc.director.getWinSize().height},rss.top=function(){return cc.p(cc.director.getWinSize().width/2,cc.director.getWinSize().height)},rss.bottom=function(){return cc.p(cc.director.getWinSize().width/2,0)},rss.left=function(){return cc.p(0,cc.director.getWinSize().height/2)},rss.right=function(){return cc.p(cc.director.getWinSize().width,cc.director.getWinSize().height/2)},rss.center=function(){return cc.p(cc.director.getWinSize().width/2,cc.director.getWinSize().height/2)},rss.pause=function(){rss.keys[cc.KEY.p]=!0},rss.pauseInput=function(){return rss.keys[cc.KEY.p]},rss.restartInput=function(){return rss.keys[cc.KEY.r]},rss.upInput=function(){return rss.keys[cc.KEY.w]||rss.keys[cc.KEY.up]},rss.downInput=function(){return rss.keys[cc.KEY.s]||rss.keys[cc.KEY.down]},rss.rightInput=function(){return rss.keys[cc.KEY.d]||rss.keys[cc.KEY.right]},rss.leftInput=function(){return rss.keys[cc.KEY.a]||rss.keys[cc.KEY.left]},rss.xInput=function(){return this.r.rightInput()||this.r.leftInput()},rss.yInput=function(){return this.upInput()||this.downInput()},rss.xyInput=function(){return this.upInput()||this.downInput()||this.r.rightInput()||this.r.leftInput()},rss.setAlpha=function(a,b){return cc.color(a.r,a.g,a.b,b)},rss.scaleVerts=function(a,b){var c=[];return a.forEach(function(a){c.push(cc.p(a.x*b,a.y*b))}),c},rss.log=function(a){cc.log("COCOS: "+a)};var rss=rss||{};rss.chipmunk="chipmunk",rss.box2D="box2d",rss.physics=rss.chipmunk,rss.g=100,rss.gravity=-500,rss.twoPI=2*Math.PI,rss.keys=[],rss.colors={yellow:new cc.color(255,255,0,255),green:new cc.color(0,255,0,255),purple:new cc.color(174,0,255,255),red:new cc.color(255,0,0,255),pink:new cc.color(255,0,255,255),orange:new cc.color(255,78,0,255),maroon:new cc.color(172,6,84,255),brown:new cc.color(145,58,6,255),blue:new cc.color(6,87,234,255),black:new cc.color(0,0,0,255),white:new cc.color(255,255,255,255)},rss.res={spaceship0_png:"res/spaceship/0.png",spaceship0_2png:"res/spaceship/0_2.png",spaceship_png:"res/spaceship/spaceship.png",spaceship_plist:"res/spaceship/spaceship.plist",button_outer_png:"res/buttons/button-outer.png",button_n_inner_png:"res/buttons/button_n-inner.png",button_s_inner_png:"res/buttons/button_s-inner.png",start_n_text_png:"res/buttons/start_n-text.png",start_s_text_png:"res/buttons/start_s-text.png",restart_n_text_png:"res/buttons/restart_n-text.png",restart_s_text_png:"res/buttons/restart_s-text.png"},rss.resources=[];for(var i in rss.res)rss.resources.push(rss.res[i]);rss.spaceship={mass:1,acc:1e3},rss.spaceship.maxImp=50*rss.spaceship.mass,rss.tag={player:1,ground:2,fuel:3,landingPad:4,startFinish:5,star:6,invisible:7,gameLayer:99,statsLayer:98},rss.player={states:{landed:0,flying:1,refuelling:2,crashed:9}},rss.player.stateNames={0:"landed",1:"flying",2:"refuelling",9:"crashed"},rss.world={mass:1e7,states:{stopped:0,moving:1}},rss.item={mass:1e5},rss.star={width:30,height:30,mass:1},rss.landingPad={angle:5},rss.game={states:{ready:0,touched:1,started:2}},rss.game.stateNames={0:"ready",1:"touched",2:"started"},rss.levels=[{radius:2e3,offset:150,omega:.2}],rss.ui={},rss.ui.linewidth=2,rss.ui.button=function(a){var b=new CompositeSprite([rss.res.button_outer_png,a[0],a[1]]);return b.setColor(rss.colors.white),b.setChildColor(0,rss.colors.black),b.setChildColor(1,rss.colors.white),b},rss.ui.buttons=function(a){var b={normal:rss.ui.button(a[0]),selected:rss.ui.button(a[1])};return b},rss.ui.restartButton=function(){return rss.ui.buttons([[rss.res.button_n_inner_png,rss.res.restart_n_text_png],[rss.res.button_s_inner_png,rss.res.restart_s_text_png]])},rss.ui.startButton=function(){return rss.ui.buttons([[rss.res.button_n_inner_png,rss.res.start_n_text_png],[rss.res.button_s_inner_png,rss.res.start_s_text_png]])},rss._StaticBody=cc.Node.extend({ctor:function(a){this._super(),this.r={},this.r.startPos=a.pos,this.r.origin=a.pos,this.r.jointPs=[cc.p()],this.r.size=a.size,this.r.width=a.size.width,this.r.height=a.size.height,this.r.color=a.color||rss.colors.white},init:function(){rss.log("_StaticBody.init ..."),this._super()},addToSpace:function(a){return a.addStaticShape(this.r.shape),this},removeFromSpace:function(a){var b=this.getBody();"object"==typeof b&&a.removeBody(b);var c=this.getShape();"object"==typeof c&&a.removeShape(c),"object"==typeof this.r.draw&&(this.r.shouldDraw=!1,this.r.draw.removeFromParent()),this.removeFromParent()},getStartPos:function(){return this.r.startPos},getPos:function(){switch(rss.physics){case rss.chipmunk:return this.r.body.getPos();case rss.box2D:return this.r.body.GetPosition()}},setPos:function(a){switch(rss.physics){case rss.chipmunk:this.r.body.setPos(a);break;case rss.box2D:this.r.body.setPosition(a.x,a.y)}},getX:function(){return this.r.body.getPos().x},getY:function(){return this.r.body.getPos().y},getTopLeft:function(){var a=this.getPos();return cc.p(a.x,a.y+this.r.size.height/2)},getTopLeftV:function(){return rss.toV(this.getTopLeft())},getJointP:function(a){return a?rss.add(this.getPos(),this.r.jointPs[0]):this.r.jointPs[0]},getStartPos:function(){return this.r.startPos},getSize:function(){return this.r.size},getWidth:function(){return this.r.size.width},getHeight:function(){return this.r.size.height},getRadius:function(){return this.r.radius},getWidthRad:function(a){return this.getWidth()/this.getRadius()},getHeightRad:function(a){return this.getHeight()/this.getRadius()},getShape:function(){return this.r.shape},getBody:function(){return this.r.body},getSprite:function(){return this.r.sprite},getDraw:function(){return this.r.draw},getStartPos:function(){return this.r.startPos},getOrigin:function(){return this.r.origin},setJointP:function(a){this.r.jointPs[0]=a},getJointPs:function(){return this.r.jointPs},setJointPs:function(a){this.r.jointPs=a},setGroup:function(a){this.r.shape.group=a},getColor:function(){return this.r.color},setColor:function(a){this.r.color=a},getState:function(){return this.r.state},setState:function(a){this.r.state=a},setElasticity:function(a){this.r.shape.setElasticity(a)},setFriction:function(a){this.r.shape.setFriction(a)},setSensor:function(a){this.r.shape.setSensor(a)},setCollisionType:function(a){this.r.shape.setCollisionType(a)}}),rss._CompositeStaticBody=rss._StaticBody.extend({ctor:function(a){this._super(a),this.r.comps=[],this.r.constraints=[]},init:function(){cc.log("_CompositeStaticBody.init ..."),this._super(),this.r.comps=[],this.r.constraints=[]},addComp:function(a){this.r.comps.push(a)},addToSpace:function(a){return this.r.comps.forEach(function(b){b.addToSpace(a)}),this.r.constraints.forEach(function(b){a.addConstraint(b)}),this},addConstraint:function(a){this.r.constraints.push(a)},addConstraints:function(a){var b=this;a.forEach(function(a){b.r.constraints.push(a)})},setGroup:function(a){this.r.comps.forEach(function(b){b.r.shape.group=a})},setCollisionType:function(a){this.r.comps.forEach(function(b){b.r.shape.setCollisionType(a)})},setFriction:function(a){this.r.comps.forEach(function(b){b.setFriction(a)})},setElasticity:function(a){this.r.comps.forEach(function(b){b.setElasticity(a)})},setSensor:function(a){this.r.comps.forEach(function(b){b.setSensor(a)})}}),rss._CompositeDynamicBody=rss._CompositeStaticBody.extend({ctor:function(a){this._super(a)},init:function(){this._super()},getPos:function(){var a=0,b=0,c=this.getMass();return this.r.comps.forEach(function(d){a+=d.getX()*d.getMass()/c,b+=d.getY()*d.getMass()/c}),cc.p(a,b)},setPos:function(a,b){var c=this.getPos(),d=a-c.x,e=b-c.y;this.r.comps.forEach(function(a){var b=a.getPos().x+d,c=a.getPos().y+e;a.setPos(b,c)})},getVel:function(){var a=0,b=0,c=this.getMass();return this.r.comps.forEach(function(d){var e=d.getVel();a+=e.x*d.getMass()/c,b+=e.y*d.getMass()/c}),cp.v(a,b)},setVel:function(a,b){this.r.comps.forEach(function(c){c.setVel(a,b)})},getMass:function(){var a=0;return this.r.comps.forEach(function(b){a+=b.getMass()}),a},applyImpulse:function(a){this.r.comps.forEach(function(b){b.applyImpulse(a)})}}),rss._DynamicBody=rss._StaticBody.extend({ctor:function(a){this._super(a),this.r.mass=a.mass},init:function(){this._super()},addToSpace:function(a){return a.addBody(this.r.body),a.addShape(this.r.shape),this},getVel:function(){switch(rss.physics){case rss.chipmunk:return this.r.body.getVel();case rss.box2D:return this.r.body.GetVelocity()}},setVel:function(a){switch(rss.physics){case rss.chipmunk:this.r.body.setVel(a);break;case rss.box2D:this.r.body.SetVelocity(a.x,a.y)}},getV:function(){return rss.toV(this.getPos())},getMass:function(){return this.r.body.m},getAngle:function(){return this.r.body.a},getAngleDeg:function(){return cc.radiansToDegrees(this.r.body.a)},setAngle:function(a){this.r.body.setAngle(a)},getOffset:function(){return this.r.offset},getAngVel:function(){return this.r.body.getAngVel()},setAngVel:function(a){this.r.body.w=a},applyForce:function(a){this.r.body.applyForce(a,cp.v(0,0))},applyForceAt:function(a,b){this.r.body.applyForce(a,b)},applyImpulse:function(a){this.r.body.applyImpulse(a,cp.v(0,0))},applyImpulseAt:function(a,b){this.r.body.applyImpulse(a,b)},applyAxialImpulse:function(a){this.applyImpulse(a*this.r.body.rot.x,a*this.r.body.rot.y)}}),rss.RectBody=rss._DynamicBody.extend({ctor:function(a){this._super(a)},init:function(){return this._super(),this.r.body=new cp.Body(this.r.mass,cp.momentForBox(this.r.mass,this.r.size.width,this.r.size.height)),this.r.body.setPos(this.getStartPos()),this.r.shape=new cp.BoxShape(this.r.body,this.r.size.width,this.r.size.height),this.r.draw=new cc.DrawNode,this.addChild(this.r.draw),this},draw:function(){this.r.draw.drawRect(rss.sub(this.getPos(),cc.p(this.getWidth()/2,this.getHeight()/2)),rss.add(this.getPos(),cc.p(this.getWidth()/2,this.getHeight()/2)),rss.setAlpha(this.getColor(),255),rss.ui.linewidth,rss.setAlpha(this.getColor(),255))}}),rss.RectBody.create=function(a){return new rss.RectBody(a).init()},rss.StaticRectBody=rss._StaticBody.extend({ctor:function(a){this._super(a)},init:function(){return cc.log("StaticRectBody.init ..."),this._super(),rss.physics==rss.chipmunk?this.initChipmunk():rss.physics==rss.box2D&&this.initBox2D(),this},initChipmunk:function(){cc.log("StaticRectBody.initChipmunk ..."),this.r.body=new cp.StaticBody,this.r.body.setPos(this.getStartPos()),this.r.shape=new cp.BoxShape(this.r.body,this.r.size.width,this.r.size.height)},initBox2D:function(){var a=new Box2D.Dynamics.b2FixtureDef;a.density=1,a.friction=.5,a.restitution=.2,a.shape=new Box2D.Collision.Shapes.b2PolygonShape,a.shape.SetAsBox(.5*width/worldScale,.5*height/worldScale);var b=new Box2D.Dynamics.b2BodyDef;isDynamic?b.type=Box2D.Dynamics.b2Body.b2_dynamicBody:b.type=Box2D.Dynamics.b2Body.b2_staticBody,b.position.Set(posX/worldScale,posY/worldScale);var c=cc.Sprite.create(rss.res.fish_png);this.addChild(c,0),c.setPosition(posX,posY),b.userData={type:type,asset:c},this.r.body=world.CreateBody(b),body.CreateFixture(a)}}),rss.StaticRectBody.create=function(a){return new rss.StaticRectBody(a).init()},rss.CircBody=rss._DynamicBody.extend({ctor:function(a){a.size=cc.size(2*a.radius,2*a.radius),this._super(a),this.r.offset=a.offset||0,this.r.radius=a.radius,this.r.segments=a.segments},init:function(){return this._super(),rss.physics==rss.chipmunk?this.initChipmunk():rss.physics==rss.box2D&&this.initBox2D(),this.r.draw=new cc.DrawNode,this.addChild(this.r.draw),this},initChipmunk:function(){cc.log("Ball.init ..."),this._super(),this.r.body=new cp.Body(this.r.mass,cp.momentForCircle(this.r.mass,0,this.r.radius,cp.v(0,0))),this.r.body.setPos(this.r.startPos),this.r.shape=new cp.CircleShape(this.r.body,this.r.radius,cp.v(0,0))},initBox2D:function(){var a=new Box2D.Dynamics.b2FixtureDef;a.density=1,a.friction=.5,a.restitution=.2,a.shape=new Box2D.Collision.Shapes.b2PolygonShape,a.shape.SetAsBox(this.r.radius,this.r.radius);var b=new Box2D.Dynamics.b2BodyDef;b.type=Box2D.Dynamics.b2Body.b2_dynamicBody,b.position.Set(this.r.startPos.x,this.r.startPos.y),b.userData={type:"ball"},this.r.body=this.r.space.CreateBody(b),this.r.body.CreateFixture(a)},applyTangentialImpulse:function(a){this.r.body.applyImpulse(cp.v(a,0),cp.v(this.getX(),this.getY()+this.r.radius))},applyTorque:function(a){this.r.body.applyForce(cp.v(a,0),cp.v(this.getX(),this.getY()+this.r.radius))},getAngle:function(){return this._super()-this.r.offset},getTop:function(){return rss.addY(this.r.startPos,this.r.radius)},getSurfaceVel:function(){return this.r.body.w*this.r.radius},setSurfaceVel:function(a){this.setAngularVel(a/this.r.radius)},getAngularVel:function(){return this.r.body.w},setAngularVel:function(a){this.r.body.w=a},drawCircle:function(){this.r.draw&&(this.r.draw.clear(),this.r.draw.drawCircle(this.getPos(),this.getRadius(),2,this.getRadius(),!1,10,this.getColor()))},drawDot:function(){this.r.draw&&(this.r.draw.clear(),this.r.draw.drawDot(this.getPos(),this.getRadius(),this.getColor()))},draw:function(){this.drawDot(),this.drawCircle()}}),rss.CircBody.create=function(a){return new rss.CircBody(a).init()},rss.RectPhysicsSprite=rss.RectBody.extend({ctor:function(a){a.spriteCfg.pList?this.constructAnimSprite(a.spriteCfg):this.sprite=new cc.PhysicsSprite(a.spriteCfg.image),a.size=this.sprite.getContentSize(),this._super(a)},init:function(){return this._super(),this.sprite.setBody(this.r.body),this.addChild(this.sprite),this},constructAnimSprite:function(a){cc.spriteFrameCache.addSpriteFrames(a.pList);new cc.SpriteBatchNode(a.spriteSheet);this.sprite=new cc.PhysicsSprite("#"+a.name+"0.png");for(var b=[],c=1;4>c;c++){var d=""+c+".png",e=cc.spriteFrameCache.getSpriteFrame(d);b.push(e)}this.animation=new cc.Animation(b,.1),this.sprite.runAction(cc.animate(this.animation).repeatForever())}}),rss.RectPhysicsSprite.create=function(a){return new rss.RectPhysicsSprite(a).init()},rss.StaticRectPhysicsSprite=rss.StaticRectBody.extend({ctor:function(a){a.spriteCfg.pList?this.constructAnimSprite(a.spriteCfg):this.sprite=new cc.PhysicsSprite(a.spriteCfg.image),a.size=this.sprite.getContentSize(),this._super(a)},init:function(){return this._super(),this.sprite.setBody(this.r.body),this.addChild(this.sprite),this},constructAnimSprite:function(a){cc.spriteFrameCache.addSpriteFrames(a.pList);new cc.SpriteBatchNode(a.spriteSheet);this.sprite=new cc.PhysicsSprite("#"+a.name+"0.png");for(var b=[],c=1;4>c;c++){var d=""+c+".png",e=cc.spriteFrameCache.getSpriteFrame(d);b.push(e)}this.animation=new cc.Animation(b,.1),this.sprite.runAction(cc.animate(this.animation).repeatForever())}}),rss.RectPhysicsSprite.create=function(a){return new rss.RectPhysicsSprite(a).init()},rss.PolyBody=rss._DynamicBody.extend({ctor:function(a){a.size=cc.size(2*a.radius,a.radius+a.coneLength),this._super(a),this.r.radius=a.radius,this.coneLength=a.coneLength,this.r.segments=a.segments},init:function(){this._super(),this.r.body=new cp.Body(this.r.mass,cp.momentForBox(this.r.mass,this.r.size.width,this.r.size.height)),this.r.body.setPos(this.getStartPos());for(var a=this.r.startPos,b=[],c=cc.p(a.x,a.y-this.coneLength),d=0;180>d;d+=180/this.r.segments){var e=a.x+this.r.radius*Math.cos(cc.degreesToRadians(d+180));b.push(e);var f=a.y+this.r.radius*Math.sin(cc.degreesToRadians(d));b.push(f)}b.push(c.x,c.y);for(var g=0;g<b.length;g+=2)cc.log("x: "+b[g]),cc.log("y: "+b[g+1]);return this.r.shape=new cp.PolyShape(this.r.body,b,cp.v(0,0)),this}}),rss.PolyBody.create=function(a){return new rss.PolyBody(a).init()},rss.ConeBody=rss._DynamicBody.extend({ctor:function(a){a.size=cc.size(a.length,a.length),this._super(a),this.r.length=a.length,this.r.radius=a.radius,this.r.angle=cc.radiansToDegrees(2*this.r.radius/this.r.length),this.r.segments=a.segments,this.r.rotation=a.rotation-this.r.angle/2},init:function(){this.r.body=new cp.Body(this.r.mass,cp.momentForBox(this.r.mass,this.r.size.width,this.r.size.height)),this.r.body.setPos(this.getStartPos());var a=[];a.push(0,0);for(var b=this.r.angle/this.r.segments,c=90;c>=-90;c-=b)a.push(this.r.length*Math.cos(cc.degreesToRadians(this.r.rotation))+this.r.radius*Math.cos(cc.degreesToRadians(c+this.r.rotation)),this.r.length*Math.sin(cc.degreesToRadians(this.r.rotation))+this.r.radius*Math.sin(cc.degreesToRadians(c+this.r.rotation)));return this.r.shape=new cp.PolyShape(this.r.body,a,cp.v(0,0)),this.setJointP(cc.p(0,0)),this}}),rss.ConeBody.create=function(a){return new rss.ConeBody(a).init()},rss.CircSegmentBody=rss._DynamicBody.extend({SCALE:1,ctor:function(a){this._super(a),this.r.radius=a.radius,this.r.segments=a.segments,this.r.offset=a.offset-this.getWidth(),this.r.size.height=this.r.size.height||1,this.r.midPoint=this.r.offset+this.getWidth()/2,this.r.right=this.r.offset+this.getWidth(),this.r.left=this.r.offset,this.r.startAngle=a.startAngle,this.r.shouldPersist=!1,this.r.shouldDraw=!0},init:function(){return this._super(),this.r.isInSpace=!0,this.getWidth()>0?this.initMe():cc.log("angle should be greater than zero!"),this},initMe:function(){this.r.body=new cp.Body(this.r.mass,cp.momentForBox(this.r.mass,this.r.size.width,this.r.size.height)),this.r.body.setPos(this.getStartPos()),this.r.vertsXY=[],this.r.verts=[];var a=rss.polarToCartesian(this.r.radius*(1-this.getHeight()),this.r.right);this.r.vertsXY.push(a.x,a.y),this.r.verts.push(a);for(var b=this.getWidth()/this.r.segments,c=this.getWidth();c>=0;c-=b)a=cc.p(this.r.radius*Math.cos(c+this.r.offset),this.r.radius*Math.sin(c+this.r.offset)),this.r.vertsXY.push(a.x,a.y),this.r.verts.push(a);a=rss.polarToCartesian(this.r.radius*(1-this.getHeight()),this.r.left),this.r.vertsXY.push(a.x,a.y),this.r.verts.push(a),this.r.verts=rss.scaleVerts(this.r.verts,this.SCALE),this.r.shape=new cp.PolyShape(this.r.body,this.r.vertsXY,cp.v(0,0)),this.setJointP(cc.p(0,0)),this.anchorX=this.getStartPos().x,this.anchorY=this.getStartPos().y,this.r.draw=new cc.DrawNode,this.r.draw.setScale(1/this.SCALE),this.addChild(this.r.draw),this.startAng=this.r.body.a},getTop:function(a){return a?rss.polarToCartesian(this.r.startPos.x+this.r.radius,this.r.midPoint):rss.polarToCartesian(this.r.radius,this.getWidth()/2+this.r.midPoint)},getShapeTop:function(a){return a?rss.polarToCartesian(this.r.startPos.x+this.r.radius,this.r.midPoint):rss.polarToCartesian(this.r.radius*this.getHeight(),this.r.midPoint)},getShapeBottom:function(a){return a?rss.sub(this.getShapeTop(!0),this.getShapeTop(!1)):cc.p(0,0)},getVerts:function(a){return a?rss.offsetVerts(this.r.verts,this.r.startPos):this.r.verts},getStartAngle:function(){return this.r.startAngle},setShouldPersist:function(a){this.r.shouldPersist=a},getShouldPersist:function(){return this.r.shouldPersist},draw:function(){this.r.draw.setPosition(this.getPos()),this.r.draw.drawPoly(this.getVerts(!1).reverse(),rss.setAlpha(this.getColor(),128),rss.ui.linewidth/2,rss.setAlpha(this.getColor(),255)),this.r.draw.setAnchorPoint(.5,0),this.r.draw.setRotation(-1*rss.toDeg(this.getAngle()))},update:function(){if(this.r.draw.clear(),this.getShouldPersist())this.draw();else{var a=this.getAngle()%rss.twoPI,b=rss.toDeg(this.getStartAngle()-(a+this.getWidth()/2)),c=rss.toDeg(this.getStartAngle()-(a-this.getWidth()/2)),d=20;d>b&&c>-1*d&&this.draw()}}}),rss.CircSegmentBody.create=function(a){return new rss.CircSegmentBody(a).init()},rss.Spaceship=rss.RectPhysicsSprite.extend({DEG_VERTICAL:0,DEG_HORIZONTAL:0,ctor:function(a){cc.log("Spaceship.ctor ..."),a.spriteCfg={image:rss.res.spaceship0_png},a.mass=rss.spaceship.mass,this._super(a)},init:function(){return cc.log("Spaceship.init ..."),this._super(),this.fuel=100,this},getPos:function(){return this.r.body.p},setVel:function(a,b){this.r.body.setVel(cp.v(a,b))},incFuel:function(){this.fuel=Math.min(100,this.fuel+1)},decFuel:function(){this.fuel=Math.max(0,this.fuel-.5)},getAngle:function(){return this._super()-this.DEG_VERTICAL},setAngle:function(a){this._super(this.DEG_VERTICAL+a)},angleFromVertical:function(){return this.r.angleFromAngle(this.DEG_VERTICAL)},angleFromHorizontal:function(){return this.r.angleFromAngle(this.DEG_HORIZONTAL)},angleFromAngle:function(a){var b=this.getAngle()-a;return b>180?360-b:-180>b?b+360:-1*b},getFuel:function(){return this.fuel},update:function(a){var b=this.getPos();cc.director.getWinSize(),b.x,b.y;rss.upInput()?this.fuel>0&&(rss.keys.up+=a,this.applyImpulse(cp.v(0,Math.min(this.getMass()*rss.keys.up*rss.spaceship.acc,rss.spaceship.maxImp)))):rss.keys.up=0,rss.downInput()&&this.applyImpulse(cp.v(0,-1*this.getMass()*a*rss.spaceship.acc)),rss.rightInput()&&this.applyImpulse(cp.v(this.getMass()*a*1e3,0)),rss.leftInput()&&this.applyImpulse(cp.v(-1*this.getMass()*a*1e3,0)),this.setAngle(0),this.setAngVel(0),rss.player.state==rss.player.states.refuelling&&this.incFuel()}}),rss.Spaceship.create=function(a){return new rss.Spaceship(a).init()};var Star=rss.CircBody.extend({ctor:function(a){cc.log("Spaceship.ctor ..."),a.radius=rss.star.width/2,a.mass=rss.star.mass,a.size=cc.size(rss.star.width,rss.star.width),this._super(a),this.r.shouldDraw=!0},init:function(){return this._super(),this.setCollisionType(rss.tag.star),this.setSensor(!0),this},attachToWorld:function(a){this.r.constraints=rss.fixedJoint(this,a,a.START_ANGLE)},getConstraints:function(){return this.r.constraints},draw:function(){this.drawCircle(),this.drawDot()},drawCircle:function(){this.r.draw.drawCircle(this.getPos(),this.getRadius(),0,2*this.getRadius(),!1,rss.ui.linewidth,rss.setAlpha(this.getColor(),255))},drawDot:function(){this.r.draw.drawDot(this.getPos(),this.getRadius(),rss.setAlpha(this.getColor(),128))},update:function(){this.r.shouldDraw&&(this.r.draw.clear(),this.draw())}});Star.create=function(a){return new Star(a).init()};var CompositeSprite=cc.Sprite.extend({child_resources:null,components:null,ctor:function(a){cc.log("Sprite.ctor ..."),this._super(a.shift()),this.child_resources=a,this.init()},init:function(){this.setChildren(this.child_resources)},setChildren:function(a){this.removeAllChildren(),a.forEach(function(a,b){var c=new cc.Sprite(a);c.setPosition(cc.p(this.width/2,this.height/2)),this.addChild(c,b)},this),this.components=[this].concat(this.getChildren())},setCompColor:function(a,b){this.components[a].color=b},setChildColor:function(a,b){this.getChildren()[a].setColor(b)}}),World=rss.CircBody.extend({ctor:function(a){this._super(a)},init:function(){return this._super(),this.draw(),this},draw:function(){this.r.draw.clear(),this.drawCircle(),this.drawDot()},drawCircle:function(){this.r.draw.drawCircle(this.getPos(),this.getRadius()+rss.ui.linewidth,0,2*this.getRadius(),!1,2*rss.ui.linewidth,rss.setAlpha(this.getColor(),200))},drawDot:function(){this.r.draw.drawDot(this.getPos(),this.getRadius(),rss.setAlpha(this.getColor(),128))}});World.create=function(a){return new World(a).init()};var _Level=rss._CompositeDynamicBody.extend({START_ANGLE:Math.PI/2,ctor:function(a){cc.log("Level.ctor ..."),a.size=rss.size(),a.pos=rss.center(),this._super(a),this.cfg=rss.levels[a.level-1],cc.log("Level.ctor")},init:function(){return cc.log("Level.init ..."),this._super(),this.addWorldMachine(),this.addItems(),cc.log("Level.init"),this},addWorldMachine:function(){var a=World.create({pos:rss.subY(rss.center(),this.cfg.radius+this.cfg.offset),radius:this.cfg.radius,offset:this.START_ANGLE,mass:rss.world.mass,color:rss.colors.red});a.setAngle(this.START_ANGLE),rss.world.state=rss.world.states.moving,a.setCollisionType(rss.tag.ground),this.addItem(a),this.r.world=a;var b=rss.StaticRectBody.create({pos:this.getWorld().getPos(),size:cc.size(10,10)});this.addItem(b),this.addConstraints(rss.pivotJoint(b,this.getWorld()))},addStartFinishPad:function(a,b){a=rss.toRad(a),b=rss.toRad(b);var c=(this.end+a,this.addSegment(a,b,20));c.setShouldPersist(!0),c.setCollisionType(rss.tag.landingPad);var d=this.addSegment(a,b,20);d.setShouldPersist(!0),finishSensor=this.addSegment(a,b,2*rss.height()),finishSensor.setShouldPersist(!0),finishSensor.setCollisionType(rss.tag.startFinish),finishSensor.setSensor(!0),this.end+=a+b},addStar:function(a,b){var a=rss.toRad(a);this.addStarAt(this.end+a,b)},addStarAt:function(a,b){var c=Star.create({pos:cc.p(0,0),color:rss.colors.yellow}),d=(this.widthToRad(c.getWidth()),rss.add(this.getWorld().getPos(),rss.polarToCartesian(this.getWorld().getRadius()+b,this.START_ANGLE-a)));c.setPos(d),c.setCollisionType(rss.tag.star),c.setSensor(!0),this.addItem(c),c.attachToWorld(this.getWorld()),this.addConstraints(c.getConstraints())},addObstacle:function(a,b,c){a=rss.toRad(a),b=rss.toRad(b);var d=this.addSegment(a,b,c);return d.setColor(rss.colors.red),d.setCollisionType(rss.tag.ground),this.end+=a+b,d},addObstacleWithStar:function(a,b,c){this.addObstacle(a,b,c),this.addStar(-1*b/2,c+70)},addFloatingObstacle:function(a,b,c,d){a=rss.toRad(a),b=rss.toRad(b);var e=this.addSegment(a,b,c,d);return e.setColor(rss.colors.red),e.setCollisionType(rss.tag.ground),e},addFuelStrip:function(a,b,c){a=rss.toRad(a),b=rss.toRad(b);var d=this.addSegment(a,b,c);d.setColor(rss.colors.green),d.setCollisionType(rss.tag.fuel),d.setElasticity(0),this.addConstraints(rss.fixedJoint(d,this.getWorld(),this.START_ANGLE)),this.end+=a+b},addRoundObstacle:function(a,b){a=rss.toRad(a),b=rss.toRad(b);var c=this.START_ANGLE-(a+(b-a)/2),d=rss.polarToCartesian(this.r.radius,c),e=rss.CircBody.create({pos:rss.add(this.getWorld().getPos(),d),radius:this.radToWidth(b-a),mass:rss.item.mass});e.setCollisionType(rss.tag.ground),this.addConstraints(rss.fixedJoint(e,this.getWorld(),this.START_ANGLE)),this.addItem(e),this.end+=gap+width},addSegment:function(a,b,c,d){return this.addSegmentAt(this.end+a,b,c,d)},addSegmentAtDeg:function(a,b,c,d){return this.addSegmentAt(rss.toRad(a),rss.toRad(b),c,d)},addSegmentAt:function(a,b,c,d){c&&d?length=c/(this.getWorld().getRadius()+d):(d=0,length=1);var e=rss.CircSegmentBody.create({pos:this.getWorld().getPos(),size:cc.size(b,length),radius:this.getWorld().getRadius()+d+c,segments:20*rss.toDeg(b)/5,startAngle:a,offset:this.START_ANGLE-a,mass:rss.item.mass,space:rss.game.space,omega:this.cfg.omega});return e.setLocalZOrder(-10),this.addConstraints(rss.fixedJoint(e,this.getWorld(),this.START_ANGLE)),this.addItem(e)},addItem:function(a){return a.setGroup(rss.tag.ground),this.addComp(a),this.getParent().addChild(a),a},widthToRad:function(a){return a/this.getWorld().getRadius()},widthToDeg:function(a){return cc.radiansToDegrees(this.widthToRad(a))},radToWidth:function(a){return this.r.radius*a},degToWidth:function(a){return this.radToWidth(cc.degreesToRadians(a))},stop:function(){rss.world.state=rss.world.states.stopped},resume:function(){rss.world.state=rss.world.states.moving},getAngle:function(){return this.getWorld().getAngle()},getWorld:function(){return this.r.world},update:function(a){rss.world.state==rss.world.states.moving&&rss.game.state==rss.game.states.touched?this.getWorld().setAngVel(this.cfg.omega):rss.world.state==rss.world.states.stopped&&this.getWorld().setAngVel(0),this.r.comps.forEach(function(b){"undefined"!=typeof b.update&&b.update(a)})}}),Level1=_Level.extend({addItems:function(){this.end=rss.toRad(-1*rss.landingPad.angle/2),this.addStartFinishPad(0,rss.landingPad.angle),this.addObstacleWithStar(2,5,30),this.addObstacleWithStar(2,2,40),this.addObstacleWithStar(2,2,50),this.addObstacleWithStar(2,3,60),this.addObstacleWithStar(2,3,70),this.addFuelStrip(2,10,20),this.addFloatingObstacle(4,2,30,300),this.addObstacleWithStar(4,2,100,150),this.addFloatingObstacle(0,2,30,300),this.addObstacleWithStar(0,2,100,150),this.addFloatingObstacle(0,2,30,300),this.addObstacleWithStar(0,2,100,150),this.addObstacle(8,2,120),this.addObstacle(2,2,100),this.addObstacle(2,2,70),this.addObstacle(2,2,50),this.addFuelStrip(1,15,20),this.addObstacle(2,2,30),this.addObstacle(2,2,40),this.addObstacle(2,2,50),
this.addObstacle(4,3,90),this.addObstacle(2,3,80),this.addObstacle(2,3,70),this.addObstacle(2,2,100),this.addObstacle(2,2,20),this.addObstacle(2,2,100),this.addObstacle(4,3,90),this.addObstacle(2,3,80),this.addObstacle(2,3,70),this.addFuelStrip(3,30),this.addObstacle(4,3,50),this.addObstacle(2,3,70),this.addObstacle(2,3,90),this.addObstacle(2,3,110),this.addObstacle(2,3,130),this.addObstacle(2,3,130),this.addObstacle(5,3,70),this.addObstacle(2,3,130),this.addObstacle(2,3,170),this.addObstacle(2,2,130),this.addObstacle(2,3,170),this.addObstacle(2,3,170),this.addObstacle(2,2,130),this.addObstacle(2,2,130),this.addObstacle(2,2,130),this.addObstacle(4,2,150),this.addObstacle(2,2,170),this.addObstacle(2,2,50),this.addObstacle(2,2,30),this.addObstacle(3,2,170),this.addObstacle(3,3,180),this.addObstacle(3,3,140),this.addObstacle(2,2,120),this.addObstacle(2,3,50),this.addObstacle(3,3,130),this.addObstacle(2,2,120),this.addObstacle(2,3,50),this.addObstacle(3,3,130),this.addObstacle(2,2,120),this.addObstacle(2,3,50),this.addObstacle(3,3,130),this.addObstacle(2,2,120),this.addObstacle(2,3,50),this.addObstacle(3,3,130),this.addObstacle(2,2,120)}});Level1.create=function(a){return new Level1(a).init()},rss.BaseLayer=cc.Layer.extend({ctor:function(){this._super(),this.r={}}});var MoveableObjectsLayer=rss.BaseLayer.extend({controllee:null,ctor:function(a){this._super()},init:function(){this._super(),this.constructListeners()}}),GameLayer=rss.BaseLayer.extend({ctor:function(a){cc.log("GameLayer.ctor ..."),this._super(),this.constructListeners(),cc.log("GameLayer.ctor")},constructListeners:function(){cc.eventManager.addListener({event:cc.EventListener.KEYBOARD,onKeyPressed:function(a,b){a==cc.KEY.p?rss.keys[a]=!rss.keys[a]:rss.keys[a]=!0},onKeyReleased:function(a,b){a!=cc.KEY.p&&(rss.keys[a]=!1)}},this),cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegan:function(){return rss.keys[cc.KEY.up]=!0,!0},onTouchEnded:function(){rss.keys[cc.KEY.up]=!1}},this)},processTouchDragEvent:function(a){var b=cc.director.getWinSize(),c=a.getDelta(),d=this.man.getPos();d=cc.pAdd(d,c),d=cc.pClamp(d,cc.p(0,0),cc.p(b.width,b.height)),this.controllee.setPos(d.x,d.x),d=null},init:function(){return this._super(),this.initActors(),rss.game.state=rss.game.states.ready,cc.log("Ready!"),this},initActors:function(){cc.log("GameLayer.init ...");var a=new Level1({level:1});this.addChild(a),a.init(),a.setElasticity(0),a.setFriction(0),a.addToSpace(rss.game.space),this.r.level=a,rss.world.state=rss.world.state.stopped;var b=this.getLevel().getWorld().getTop(),c=rss.Spaceship.create({pos:cc.p(),offset:cc.p(0,-10)});c.setPos(rss.addY(b,c.getSize().height/2+20)),c.addToSpace(rss.game.space),this.addChild(c),c.setElasticity(0),c.setFriction(0),c.setGroup(rss.tag.player),c.setCollisionType(rss.tag.player),this.r.player=c,rss.player.state=rss.player.states.landed;var d=rss.top().y,e=d-b.y+10,f=rss.StaticRectBody.create({pos:cc.p(rss.center().x,b.y+e/2),size:cc.size(0,e)}).addToSpace(rss.game.space);f.setJointPs([cc.p(0,f.getSize().height/2),cc.p(0,-1*f.getSize().height/2)]),f.setGroup(rss.tag.player),f.setSensor(!0),rss.game.space.addConstraints(rss.grooveJoint(f,this.getPlayer()))},getLevel:function(){return this.r.level},getPlayer:function(){return this.r.player},update:function(a){var b=rss.toDeg(this.getLevel().getWorld().getAngle());rss.upInput()&&rss.game.state==rss.game.states.ready?(rss.game.state=rss.game.states.touched,this.getParent().getChildByTag(rss.tag.statsLayer).updateMsg("")):b>rss.landingPad.angle/2&&(rss.game.state=rss.game.states.started),this.getPlayer().update(a),this.getLevel().update(a),this.getParent().getChildByTag(rss.tag.statsLayer).updateFuelMeter(this.getPlayer().getFuel()),this.getParent().getChildByTag(rss.tag.statsLayer).updateDistanceMeter(rss.toDeg(this.getLevel().getWorld().getAngle())),rss.game.space.gravity=rss.mult(rss.unitVecFromTo(this.getLevel().getWorld().getPos(),this.getPlayer().getPos()),rss.gravity)}});GameLayer.create=function(a){return new GameLayer(a).init()};var StatsLayer=rss.BaseLayer.extend({FONT_SIZE:20,MSG_FONT_SIZE:40,ctor:function(){this._super()},init:function(){return this._super(),this.constructFuelLabel(),this.constructAngleLabel(),this.constructMsg(),this},constructFuelLabel:function(){var a="Fuel: 100".length*this.FONT_SIZE;this.fuel=cc.LabelTTF.create("Fuel: 100","res/Arial.ttf",this.FONT_SIZE,cc.size(a,2*this.FONT_SIZE),cc.TEXT_ALIGNMENT_LEFT,cc.TEXT_ALIGNMENT_CENTER),this.fuel.setPosition(rss.right().x-a,rss.top().y-2*this.FONT_SIZE),this.addChild(this.fuel)},constructAngleLabel:function(){var a="Angle: 360".length*this.FONT_SIZE;this.r.angle=cc.LabelTTF.create("Angle: 0","res/Arial.ttf",this.FONT_SIZE,cc.size(a,2*this.FONT_SIZE),cc.TEXT_ALIGNMENT_RIGHT,cc.TEXT_ALIGNMENT_CENTER),this.r.angle.setPosition(cc.p(rss.left().x+a/2,rss.top().y-2*this.FONT_SIZE)),this.addChild(this.r.angle)},constructMsg:function(){var a="Touch to begin!",b=a.length*this.MSG_FONT_SIZE;this.msg=cc.LabelTTF.create(a,"res/Arial.ttf",this.MSG_FONT_SIZE,cc.size(b,2*this.MSG_FONT_SIZE),cc.TEXT_ALIGNMENT_CENTER,cc.TEXT_ALIGNMENT_CENTER),this.msg.setPosition(rss.center()),this.addChild(this.msg)},updateFuelMeter:function(a){this.fuel.setString("Fuel: "+Math.round(a))},updateDistanceMeter:function(a){this.r.angle.setString("Angle: "+Math.round(a))},updateMsg:function(a){this.msg.setString(a)}});StatsLayer.create=function(){return(new StatsLayer).init()};var MenuLayer=rss.BaseLayer.extend({ctor:function(){cc.log("MenuLayer.ctor ..."),this._super()},init:function(){cc.log("MenuLayer.init ..."),this._super();var a=cc.director.getWinSize(),b=cc.p(a.width/2,a.height/2),c=new cc.MenuItemSprite(rss.ui.startButton().normal,rss.ui.startButton().selected,this.onPlay,this),d=new cc.Menu(c);return d.setPosition(b),this.addChild(d),this},onPlay:function(){cc.log("MenuLayer.onPlay ..."),cc.director.runScene(new GameScene)}});MenuLayer.create=function(){return(new MenuLayer).init()};var GameOverLayer=rss.BaseLayer.extend({ctor:function(){cc.log("MenuLayer.ctor ..."),this._super()},init:function(){cc.log("MenuLayer.init ..."),this._super();var a=cc.director.getWinSize(),b=cc.p(a.width/2,a.height/2),c=new cc.MenuItemSprite(rss.ui.restartButton().normal,rss.ui.restartButton().selected,this.onPlay,this),d=new cc.Menu(c);return d.setPosition(b),this.addChild(d),this},onPlay:function(){cc.director.resume(),cc.director.runScene(new GameScene)}});GameOverLayer.create=function(){return(new GameOverLayer).init()},rss.BaseScene=cc.Scene.extend({ctor:function(){this._super(),this.r={}}});var MenuScene=rss.BaseScene.extend({onEnter:function(){cc.log("MenuScene.onEnter ..."),this._super(),this.addChild(MenuLayer.create())}}),GameScene=rss.BaseScene.extend({onEnter:function(){cc.log("Scene.onEnter ..."),this._super(),this.initPhysics(),this.addChild(GameLayer.create(rss.game.space),0,rss.tag.gameLayer),this.addChild(StatsLayer.create(),0,rss.tag.statsLayer),this.scheduleUpdate()},initPhysics:function(){rss.game.space=new cp.Space,rss.game.space.addCollisionHandler(rss.tag.player,rss.tag.ground,this.collisionGroundBegin.bind(this),null,null,this.collisionGroundSeparate.bind(this)),rss.game.space.addCollisionHandler(rss.tag.player,rss.tag.fuel,this.collisionFuelBegin.bind(this),null,null,this.collisionFuelSeparate.bind(this)),rss.game.space.addCollisionHandler(rss.tag.player,rss.tag.landingPad,this.collisionLandingPadBegin.bind(this),null,null,this.collisionLandingPadSeparate.bind(this)),rss.game.space.addCollisionHandler(rss.tag.player,rss.tag.startFinish,this.collisionStartFinishBegin.bind(this),null,null,null),rss.game.space.addCollisionHandler(rss.tag.player,rss.tag.star,this.collisionStarBegin.bind(this),null,null,null)},collisionGroundBegin:function(){if(rss.player.state!=rss.player.states.refuelling){cc.log("collisionGround.begin");this.getChildByTag(rss.tag.gameLayer).player;rss.player.state=rss.player.states.crashed,cc.log("Game Over!"),cc.director.pause(),this.addChild(GameOverLayer.create())}return!0},collisionGroundSeparate:function(){cc.log("collisionGround.separate"),rss.player.state!=rss.player.states.refuelling&&(rss.player.state=rss.player.states.flying)},collisionFuelBegin:function(){return cc.log("collisionFuel.begin"),rss.player.state=rss.player.states.refuelling,!0},collisionFuelSeparate:function(){cc.log("collisionFuel.separate"),rss.player.state=rss.player.states.flying},collisionLandingPadBegin:function(){return cc.log("collisionLandingPad.begin"),rss.player.state=rss.player.states.landed,rss.world.state=rss.world.states.stopped,!0},collisionLandingPadSeparate:function(){cc.log("collisionLandingPad.separate"),(rss.game.state==rss.game.states.touched||rss.game.state==rss.game.states.started)&&(rss.player.state=rss.player.states.flying,rss.world.state=rss.world.states.moving)},collisionStartFinishBegin:function(){return cc.log("collisionStartFinish.begin"),rss.game.state==rss.game.states.started&&(this.getChildByTag(rss.tag.statsLayer).updateMsg("Completed!"),cc.director.pause(),cc.log("GAME OVER"),this.addChild(GameOverLayer.create())),!0},collisionStarBegin:function(a){cc.log("CollisionStarBegin");var b=this,c=this.getChildByTag(rss.tag.gameLayer),d=a.getShapes()[1];c.getChildren().forEach(function(a){"undefined"!=typeof a.getShape&&a.getShape()==d&&b.addObjectToRemove(a)})},addObjectToRemove:function(a){this.r.objectsToRemove.push(a)},shouldPhysicsRun:function(){return!rss.pauseInput()&&(rss.game.state==rss.game.states.touched||rss.game.state==rss.game.states.started)},update:function(a){cc.log("state: "+rss.game.stateNames[rss.game.state]),this.r.objectsToRemove=[],rss.pauseInput()||(rss.game.space.step(a),this.getChildByTag(rss.tag.gameLayer).update(a)),rss.restartInput()&&cc.director.runScene(new GameScene);this.r.objectsToRemove.forEach(function(a){a.removeFromSpace(rss.game.space)})}}),GameOverScene=rss.BaseScene.extend({onEnter:function(){cc.log("MenuScene.onEnter ..."),this._super(),this.addChild(GameOverLayer.create())}});
//# sourceMappingURL=sourceMap.map